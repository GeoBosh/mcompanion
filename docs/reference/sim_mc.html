<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate a multi-companion matrix — sim_mc • mcompanion</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simulate a multi-companion matrix — sim_mc" />
<meta property="og:description" content="Simulate a multi-companion matrix with partially or  fully specified spectral
  properties." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mcompanion</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/GeoBosh/mcompanion">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate a multi-companion matrix</h1>
    
    <div class="hidden name"><code>sim_mc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulate a multi-companion matrix with partially or  fully specified spectral
  properties.</p>
    </div>

    <pre class="usage"><span class='fu'>sim_mc</span>(<span class='no'>dim</span>, <span class='no'>mo</span>, <span class='kw'>mo.col</span> <span class='kw'>=</span> <span class='no'>dim</span>, <span class='no'>eigval</span>, <span class='no'>len.block</span>, <span class='kw'>type.eigval</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
       <span class='no'>co</span>, <span class='no'>eigabs</span>, <span class='no'>eigsign</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"real"</span>,
       <span class='kw'>value</span> <span class='kw'>=</span> <span class='st'>"real"</span>, <span class='kw'>value.type</span> <span class='kw'>=</span> <span class='st'>""</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dim</th>
      <td><p>dimension of the matrix.</p></td>
    </tr>
    <tr>
      <th>mo</th>
      <td><p>multi-companion order.</p></td>
    </tr>
    <tr>
      <th>mo.col</th>
      <td><p>number of structural columns.</p></td>
    </tr>
    <tr>
      <th>eigval</th>
      <td><p>eigenvalues, one for each Jordan block.</p></td>
    </tr>
    <tr>
      <th>len.block</th>
      <td><p>lengths of the Jordan blocks corresponding to <code>eigval</code>.</p></td>
    </tr>
    <tr>
      <th>type.eigval</th>
      <td><p>types of the eigenvalues, a character vector</p></td>
    </tr>
    <tr>
      <th>co</th>
      <td><p><code>co</code> parameters, see Details.</p></td>
    </tr>
    <tr>
      <th>eigabs</th>
      <td><p>moduli (absolute values) of eigenvalues, see Details.</p></td>
    </tr>
    <tr>
      <th>eigsign</th>
      <td><p>signs or complex arguments of eigenvalues, see Details.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>passed down to generators (???)</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>what to return</p></td>
    </tr>
    <tr>
      <th>value.type</th>
      <td><p>type of the value (???)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments to passed on to <code>sim_chains</code> and
    <code>sim_numbers</code>, see Details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    

<p><code>sim_mc</code> generates a multi-companion matrix of dimension
  <code>dim x dim</code> and multi-companion order <code>mo</code>. The matrix has
  the spectral properties specified by the arguments. Values that cannot
  be inferred from the arguments are simulated.</p>
<p>Arguments <code>dim</code>, <code>mo</code>, and <code>mo.col</code> define the
  structure of the matrix. The first two are compulsory but the last
  one, <code>mo.col</code>, is optional. If no other arguments are supplied
  <code>sim_mc</code> produces a matrix with all spectral parameters
  simulated.</p>
<p>The number of non-zero eigenvalues is at most <code>mo.col</code>.
  If <code>mo.col &lt; dim</code> the multi-companion matrix has structural
  eigenvectors/chains corresponding to the zero eigenvalue(s), see
  the references. These chains are generated automatically.</p>
<p>Arguments <code>type.eigval</code>, <code>eigabs</code>, <code>eigsign</code> and
  <code>eigval</code> are vectors used to specify the types and the values of
  the eigenvalues. Any or all of them may be missing or NULL. Those
  present must have the same length.</p>
<p>It is not necessary to specify eigenvalues and eigenvectors
  corresponding to eigenvalues equal to zero, since the structural
  eigenchains needed when <code>mo.col &lt; dim</code> are created automatically.
  In practice, the number of the non-zero eigenvalues is usually equal
  to <code>mo.col</code>.  The net effect is that the arguments specifying the
  spectral structure of the matrix normally need to specify the spectral
  information about the non-zero <code>eigval</code> only.</p>
<p>Some or all of the eigenvalues may be specified partially or fully
  using arguments <code>eigabs</code>, <code>eigsign</code>, and
  <code>eigval</code>. Non-NA entries in <code>eigval</code> specify complete
  eigenvalues. Non-NA entries in <code>eigabs</code> specify absolute values
  of eigenvalues. Non-NA entries in <code>eigsign</code> specify signs of real
  eigenvalues or complex arguments of complex eigenvalues. Generally, if
  the entry for an eigenvalue in <code>eigval</code> is a number (not
  <code>NA</code>), then the corresponding entries in <code>eigabs</code> and
  <code>eigsign</code> will be <code>NA</code>. This is not enforced and a limited
  check for consistency is made in case of redundant information.</p>
<p><code>type.eigval</code> is a character vector describing the types of the
  eigenvalues, where "r", "c", and "cp" stand for real, complex, and
  complex pair, respectively. It is best to have one entry only for each
  complex pair (specified by "cp"), rather than two "c" entries.</p>
<p>If <code>type.eigval</code> is NULL (default) and <code>eigval</code> is supplied,
  then <code>type.eigval</code> is inferred from the imaginary part of
  <code>eigval</code> ("r" or "cp"), if it is complex.</p>
<p>For compatibility with older versions of this function <code>eigval</code>
  may be a character vector in which case it is simply assigned to
  <code>type.eigval</code>.</p>
<p>If both, <code>type.eigval</code> and <code>eigval</code>, are missing a default
  allocation of the types of the eigenvalues is chosen.</p>

<p><strong>TODO: complete the description below.</strong></p>
<p>The remaining spectral parameters may be specified with the argument
  <code>co</code> with missing entries for the "free" entries. (!!! This is not
  complete, it may be better to have separate arguments for the absolute
  value and the angle, as for eigenvalues, and an option for
  normalisation of these coefficients. ???)</p>
<p>Generators other than the default ones may be specified in the
  <code>...</code>  argument. These are passed to <code>sim_numbers</code> and
  <code>sim_chains</code>.  Again, for the "co" arguments the support
  is not finished.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>if <code>value.type</code> is the character string <code>"matrix"</code>, the
  required multi-companion matrix. Otherwise, if
  <code>value.type=="list"</code>, a list containing also the spectral
  information (this list is the same as the one from
  <code><a href='make_mcmatrix.html'>make_mcmatrix</a></code>)).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p><!-- % -->
    <!-- % bibentry: boshnakov2002mc -->
Boshnakov GN (2002).
``Multi-companion matrices.''
<em>Linear Algebra Appl.</em>, <b>354</b>, pp. 53--83.
ISSN 0024-3795, <a href='http://dx.doi.org/10.1016/S0024-3795(01)00475-X'>http://dx.doi.org/10.1016/S0024-3795(01)00475-X</a>.
<!-- % end:bibentry:  boshnakov2002mc --></p>
<p><!-- % bibentry: boshnakov2009gen -->
Boshnakov GN and Iqelan BM (2009).
``Generation of time series models with given spectral
properties.''
<em>J. Time Series Anal.</em>, <b>30</b>(3), pp. 349--368.
ISSN 0143-9782, <a href='http://dx.doi.org/10.1111/j.1467-9892.2009.00617.x'>http://dx.doi.org/10.1111/j.1467-9892.2009.00617.x</a>.
<!-- % end:bibentry:  boshnakov2009gen --></p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>A canonical form is needed, especially when there are repeated
  eigenvalues whose eigenvectors may be chosen to be orthogonal, at
  least. (nyakade v zapiskite mi tryabva da ima kanonichna forma!)</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'>

<p><code><a href='https://rdrr.io/pkg/gbutils/man/sim_numbers.html'>gbutils::sim_numbers</a></code> and
  <code><a href='sim_chains.html'>sim_chains</a></code> for arguments that control the
  distributions of the random numbers.</p>
<p><code><a href='make_mcmatrix.html'>make_mcmatrix</a></code> creates the matrix.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>m0</span> <span class='kw'>&lt;-</span> <span class='fu'>sim_mc</span>(<span class='fl'>3</span>,<span class='fl'>2</span>)   <span class='co'># simulate 3x3 2-companion matrix</span>
<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span>(<span class='no'>m0</span>$<span class='no'>eigval</span>)      <span class='co'># eigval random, so their abs values</span></div><div class='output co'>#&gt; [1] 0.5935538 0.9062973 0.9062973</div><div class='input'>
<span class='co'># now fix moduli of eigenvalues, and</span>
<span class='co'># ask for one real ev and one complex pair of ev's</span>
<span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='fu'>sim_mc</span>(<span class='fl'>3</span>,<span class='fl'>2</span>,<span class='kw'>eigabs</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.25</span>,<span class='fl'>0.5</span>), <span class='kw'>type.eigval</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"r"</span>,<span class='st'>"cp"</span>))
<span class='no'>m1</span>$<span class='no'>eigval</span></div><div class='output co'>#&gt; [1] -0.2500000+0.0000000i -0.4345654+0.2472912i -0.4345654-0.2472912i</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span>(<span class='no'>m1</span>$<span class='no'>eigval</span>)</div><div class='output co'>#&gt; [1] 0.25 0.50 0.50</div><div class='input'>
<span class='co'># same as above, since type.eigval happens to be the default</span>
<span class='co'># dim is odd, by default first ev is real, rest are complex pairs</span>
<span class='no'>m1a</span> <span class='kw'>&lt;-</span> <span class='fu'>sim_mc</span>(<span class='fl'>3</span>,<span class='fl'>2</span>,<span class='kw'>eigabs</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.25</span>,<span class='fl'>0.5</span>))
<span class='no'>m1a</span>$<span class='no'>eigval</span></div><div class='output co'>#&gt; [1] -0.2500000+0.0000000i  0.0882546+0.4921495i  0.0882546-0.4921495i</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span>(<span class='no'>m1a</span>$<span class='no'>eigval</span>)</div><div class='output co'>#&gt; [1] 0.25 0.50 0.50</div><div class='input'>
<span class='co'># simulate 6x6 4-companion matrix</span>
<span class='co'># with ev's at the seasonal frequencies (1.57 3.141593 -1.57)</span>
<span class='co'># and random moduli. 3 complex pairs of ev's</span>
<span class='no'>m2</span> <span class='kw'>&lt;-</span> <span class='fu'>sim_mc</span>(<span class='fl'>6</span>,<span class='fl'>4</span>, <span class='kw'>eigsign</span> <span class='kw'>=</span> <span class='no'>pi</span>*<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>/<span class='fl'>2</span>,<span class='fl'>1</span>,-<span class='fl'>1</span>/<span class='fl'>2</span>) )
<span class='fu'><a href='https://rdrr.io/r/base/complex.html'>Arg</a></span>(<span class='no'>m2</span>$<span class='no'>eigval</span>)</div><div class='output co'>#&gt; [1]  1.570796  3.141593 -1.570796 -1.570796 -3.141593  1.570796</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Georgi N. Boshnakov</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Georgi N. Boshnakov.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


