<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>PAR representations of VAR models — VAR2pcfilter • mcompanion</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PAR representations of VAR models — VAR2pcfilter"><meta name="description" content="

Give the univariate periodic autoregression representation of a VAR
  model. Several arrangements are supported as discussed by
  Boshnakov and Iqelan (2009)
. If the VAR model
  contains unit roots on the unit circle, then the univariate model is
  periodically integrated."><meta property="og:description" content="

Give the univariate periodic autoregression representation of a VAR
  model. Several arrangements are supported as discussed by
  Boshnakov and Iqelan (2009)
. If the VAR model
  contains unit roots on the unit circle, then the univariate model is
  periodically integrated."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mcompanion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/GeoBosh/mcompanion/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>PAR representations of VAR models</h1>

      <div class="d-none name"><code>VAR2pcfilter.Rd</code></div>
    </div>

    <div class="ref-description section level2">


<p>Give the univariate periodic autoregression representation of a VAR
  model. Several arrangements are supported as discussed by
  Boshnakov and Iqelan (2009)
. If the VAR model
  contains unit roots on the unit circle, then the univariate model is
  periodically integrated.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">VAR2pcfilter</span><span class="op">(</span><span class="va">phi</span>, <span class="va">...</span>, <span class="va">Sigma</span>, <span class="va">Phi0</span>, <span class="va">Phi0inv</span>, <span class="va">D</span>, what <span class="op">=</span> <span class="st">"coef"</span>, <span class="va">perm</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-phi">phi<a class="anchor" aria-label="anchor" href="#arg-phi"></a></dt>
<dd><p>VAR coefficients, a matrix, see Details.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>alternative way to specify the VAR coefficients by giving a matrix
    for each lag in separate arguments, see section ‘Details’.</p></dd>

  <dt id="arg-sigma">Sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>covariance matrix of innovations.</p></dd>

  <dt id="arg-phi-">Phi0<a class="anchor" aria-label="anchor" href="#arg-phi-"></a></dt>
<dd><p>coefficient matrix at lag 0 (alternative to <code>Sigma</code>).</p></dd>

  <dt id="arg-phi-inv">Phi0inv<a class="anchor" aria-label="anchor" href="#arg-phi-inv"></a></dt>
<dd><p>inverse of <code>Phi0</code> (alternative to <code>Sigma</code> and
    <code>Phi0</code>). If <code>Phi0inv</code> is lower triangular, then it is the
    Cholesky factor of Sigma (in Sigma\({} = LDL'\)).</p></dd>

  <dt id="arg-d">D<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>the diagonal matrix corresponding to <code>Phi0</code>, not used if
    <code>Sigma</code> is specified.</p></dd>

  <dt id="arg-what">what<a class="anchor" aria-label="anchor" href="#arg-what"></a></dt>
<dd><p>what to return, a string. If equal to <code>"coef"</code>,
    return the PAR coefficients only (as a matrix with one row for each
    “season”); if equal to <code>"coef.and.var"</code> return also the
    innovation variances. Otherwise return additional quantities (useful
    for exploration).</p></dd>

  <dt id="arg-perm">perm<a class="anchor" aria-label="anchor" href="#arg-perm"></a></dt>
<dd><p>a permutation specifying the ordering of the variables when treated
    as “seasons”. The default, <code>d:1</code>, corresponds to the U-form,
    see section ‘Details’.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<p><code>VAR2pcfilter</code> converts a VAR model to a scalar periodic
  autoregressive (PAR) model. There are various ways to specify a VAR
  model and associate its variables with seasons of the scalar
  representation, see Boshnakov and Iqelan (2009)

  for a detailed discussion and the terminology used here.</p>
<p><!-- % There is some flexibility in the model specification but in all cases, --></p>
<p>The VAR coefficients <code>phi,...</code> are those in the standard form of
  the VAR model (e.g., see Boshnakov and Iqelan 2009)
.
  There are two ways to specify them. The first is to put them side by
  side in a matrix \([\Phi_1, \ldots, \Phi_p]\) and give this matrix
  as argument <code>phi</code>. Alternatively, the matrices \(\Phi_i\) may
  be given directly as arguments to <code>VAR2pcfilter</code>, as in
  <code>VAR2pcfilter(Phi1, Phi2, Phi3, Sigma = Sigma)</code>.</p>
<p>The specification of the model can be completed by giving the
  covariance matrix, <code>Sigma</code>, of the innovations.  Alternatively,
  it is possible to give the components of the \(UDU'\) decomposition
  of <code>Sigma</code>. In this case argument <code>D</code> is a vector giving the
  diagonal of the matrix \(D\), while <code>Phi0inv</code> represents the
  upper triangular matrix \(U\). A further option is to use argument
  <code>Phi0</code> to specify the inverse of \(U\). In summary, give either
  <code>Sigma</code> or <code>D</code> and one of <code>Phi0inv</code> and <code>Phi0</code>.</p>
<p><code>Phi0</code> can e interpreted as the coefficient at lag zero in the
  U-form (Boshnakov and Iqelan 2009)
 of the VAR model.
  <code>diag(D)</code> is the variance matrix of the innovations in that
  form. <code>D</code> also gives the variances of the innovations in the PAR
  (periodic autoregression) form.</p>
<p>By default, <code>VAR2pcfilter</code> constructs the U-form of the VAR model
  and extracts the coefficients of the PAR filter from it. This means
  that the variables in the multivariate vector are given “seasons” in
  reverse order (the first variable takes the last season, and so on).
  For the reasons behind this default, see
  Boshnakov and Iqelan (2009)
.  Another
  arrangement can be chosen with the help of argument
  <code>perm</code>. <code>perm</code> should be a permutation specifying the
  desired allocation of variables to seasons. The default corresponds to
  <code>perm=d:1</code>, where <code>d</code> is the number of
  seasons. <code>perm=1:d</code> could be used to request the “natural”
  order.</p>
<p>When <code>D</code> and <code>Phi0inv</code> (or <code>Phi0</code>) are given, the
  matrix <code>Sigma</code> is not computed if argument <code>perm</code> is missing
  but it is if <code>perm</code> is present. This means that <code>perm = d:1</code>
  may be used to force the formation of <code>Sigma</code> and recomputation
  of <code>Phi0</code> and <code>Phi0inv</code>. This is redundant if the latter two
  are unit upper-triangular (which is assumed but not checked) but may
  be handy if, for example, the Cholesky decomposition with a lower
  triangular matrix is available.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<p>If <code>what="coef"</code>, a matrix containing the periodic model
  coefficients (one row for each season).</p>
<p>If <code>what="coef.and.var"</code>, a list containing the coefficients and
  the innovations' variances:</p>
<dl><dt>pcfilter</dt>
<dd><p>PAR coefficients, a matrix</p></dd>

  <dt>var</dt>
<dd><p>innovation variances, a vector</p></dd>


</dl><p>Otherwise the returned list contains an additional component,
  <code>Uform</code>, which is itself a list with components:</p>
<dl><dt>Sigma</dt>
<dd><p>covariance matrix of innovations,</p></dd>

  <dt>U0</dt>
<dd><p>coefficient for lag zero,</p></dd>

  <dt>U</dt>
<dd><p>the remaining AR coefficients,</p></dd>

  <dt>U0inv</dt>
<dd><p>the inverse of <code>U0</code>,</p></dd>

  <dt>perm</dt>
<dd><p>permutation giving the season of each variable.</p></dd>


</dl><p>Note: <code>U0</code> and <code>U</code> correspond to \(A0\) and \(A\) in the
  reference (Boshnakov and Iqelan 2009).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Boshnakov GN, Iqelan BM (2009).
“Generation of time series models with given spectral properties.”
<em>J. Time Series Anal.</em>, <b>30</b>(3), 349–368.
ISSN 0143-9782, <a href="https://doi.org/10.1111/j.1467-9892.2009.00617.x" class="external-link">doi:10.1111/j.1467-9892.2009.00617.x</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Georgi N. Boshnakov</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This function uses some non-exported internal functions:</p><dl><dt>.ldl</dt>
<dd><p>Computes the LDL' Cholesky decomposition with unit
      lower-triangular matrix L,</p></dd>

    <dt>.udu</dt>
<dd><p>Computes the UDU' Cholesky decomposition with unit
      upper-triangular matrix U.</p></dd>


</dl><p>Could export these if they are deemed more widely useful.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mf_VSform.html">mf_VSform</a></code>,
  <code><a href="sim_pcfilter.html">sim_pcfilter</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## create a pc filter</span></span></span>
<span class="r-in"><span><span class="va">rfi</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_pcfilter.html">sim_pcfilter</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rfi</span><span class="op">$</span><span class="va">pcfilter</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]        [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.3720226  0.99252054 -0.1272624</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.8155766 -0.05714582 -0.1805301</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## turn it into VAR form</span></span></span>
<span class="r-in"><span><span class="va">flt</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"MultiFilter"</span>, coef <span class="op">=</span> <span class="va">rfi</span><span class="op">$</span><span class="va">pcfilter</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">I1</span> <span class="op">&lt;-</span> <span class="fu"><a href="mf_VSform.html">mf_VSform</a></span><span class="op">(</span><span class="va">flt</span>, form<span class="op">=</span><span class="st">"I"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">I1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Phi0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Phi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]      [,2]       [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.3605587 0.6289463 -0.1037922    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.3720226 0.9925205 -0.1272624    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Phi0inv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1 0.8155766</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## from VAR to scalar form</span></span></span>
<span class="r-in"><span><span class="va">flt2</span> <span class="op">&lt;-</span> <span class="fu">VAR2pcfilter</span><span class="op">(</span><span class="va">I1</span><span class="op">$</span><span class="va">Phi</span>, Sigma <span class="op">=</span> <span class="va">I1</span><span class="op">$</span><span class="va">Phi0inv</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">I1</span><span class="op">$</span><span class="va">Phi0inv</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">flt2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]        [,2]       [,3]         [,4] [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.3720226  0.99252054 -0.1272624 0.000000e+00    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.8155766 -0.05714582 -0.1805301 1.399706e-18    0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## confirm that we are back to the original</span></span></span>
<span class="r-in"><span><span class="co">##   (VAR2pcfilter doesn't drop redundant zeroes, so we do it manually)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">flt2</span><span class="op">[</span> , <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">rfi</span><span class="op">$</span><span class="va">pcfilter</span><span class="op">)</span> <span class="co">## TRUE</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Georgi N. Boshnakov.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

