<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>PAR representations of VAR models — VAR2pcfilter • mcompanion</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="PAR representations of VAR models — VAR2pcfilter"><meta property="og:description" content="Give the pc representation of a VAR model."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mcompanion</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5-4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/GeoBosh/mcompanion/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>PAR representations of VAR models</h1>
    
    <div class="hidden name"><code>VAR2pcfilter.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Give the pc representation of a VAR model.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">VAR2pcfilter</span><span class="op">(</span><span class="va">phi</span>, <span class="va">...</span>, <span class="va">Sigma</span>, <span class="va">Phi0</span>, <span class="va">Phi0inv</span>, <span class="va">D</span>, what <span class="op">=</span> <span class="st">"coef"</span>, <span class="va">perm</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>phi</dt>
<dd><p>VAR coefficients, a matrix, see Details.</p></dd>

  <dt>...</dt>
<dd><p>VAR coefficients, a matrix for each lag, see Details.</p></dd>

  <dt>Sigma</dt>
<dd><p>covariance matrix of innovations.</p></dd>

  <dt>Phi0</dt>
<dd><p>coefficient matrix at lag 0 (alternative to <code>Sigma</code>).</p></dd>

  <dt>Phi0inv</dt>
<dd><p>inverse of <code>Phi0</code> (alternative to <code>Sigma</code> and
    <code>Phi0</code>). If <code>Phi0inv</code> is lower triangular, then it is the
    Cholesky factor of Sigma (in Sigma\({} = LDL'\)).</p></dd>

  <dt>D</dt>
<dd><p>the diagonal matrix corresponding to <code>Phi0</code>, not used if
    <code>Sigma</code> is specified.</p></dd>

  <dt>what</dt>
<dd><p>what to return, a string. If equal to <code>"coef"</code>,
    return the PAR coefficients only (as a matrix with one row for each
    ``season''); if equal to <code>"coef.and.var"</code> return also the
    innovation variances. Otherwise return additional quantities (useful
    for exploration).</p></dd>

  <dt>perm</dt>
<dd><p>a permutation specifying the ordering of the variables when treated
    as ``seasons''. The default, <code>d:1</code>, corresponds to the U-form,
    see Details.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    

<p><code>VAR2pcfilter</code> converts a VAR model to a scalar periodic autoregressive
  (PAR) model. There are various ways to specify a VAR model and
  associate its variables with seasons of the scalar representation,
  see the reference for a detailed discussion and the terminology used
  here.</p>
<p><!-- % There is some flexibility in the model specification but in all cases, --></p>
<p>The VAR coefficients <code>phi,...</code> are those in the standard form of
  the VAR model (see also the reference).  There are two ways to specify
  them. The first is to put them side by side in a matrix \([\Phi_1,
  \ldots, \Phi_p]\) and give this matrix as argument
  <code>phi</code>. Alternatively, the matrices \(\Phi_i\) may be given
  directly as arguments to <code>VAR2pcfilter</code>, as in <code>VAR2pcfilter(Phi1, Phi2,
  Phi3, Sigma = Sigma)</code>.</p>
<p>The specification of the model can be completed by giving the
  covariance matrix, <code>Sigma</code>, of the innovations.  Alternatively,
  it is possible to give the components of the \(UDU'\) decomposition
  of <code>Sigma</code>. In this case argument <code>D</code> is a vector giving the
  diagonal of the matrix \(D\), while <code>Phi0inv</code> represents the
  upper triangular matrix \(U\). A further option is to use argument
  <code>Phi0</code> to specify the inverse of \(U\). In summary, give either
  <code>Sigma</code> or <code>D</code> and one of <code>Phi0inv</code> and <code>Phi0</code>.</p>
<p><code>Phi0</code> can e interpreted as the coefficient at lag zero in the
  U-form of the VAR model and <code>diag(D)</code> is the variance matrix of
  the innovations in that form. <code>D</code> also gives the variances of the
  innovations in the PAR form.</p>
<p>By default, <code>VAR2pcfilter</code> constructs the U-form of the VAR model and
  extracts the coefficients of the PAR filter from it. This means that
  the variables in the multivariate vector are given ``seasons'' in
  reverse order (the first variable takes the last season, and so on).
  For the reasons behind this default, see the reference.  Another
  arrangement can be chosen with the help of argument
  <code>perm</code>. <code>perm</code> should be a permutation specifying the
  desired allocation of varibles to seasons. The default corresponds to
  <code>perm=d:1</code>, where <code>d</code> is the number of
  seasons. <code>perm=1:d</code> could be used to request the ``natural''
  order.</p>
<p>When <code>D</code> and <code>Phi0inv</code> (or <code>Phi0</code>) are given, the
  matrix <code>Sigma</code> is not computed if argument <code>perm</code> is missing
  but it is if <code>perm</code> is present. This means that <code>perm = d:1</code>
  may be used to force the formation of <code>Sigma</code> and recomputation
  of <code>Phi0</code> and <code>Phi0inv</code>. This is redundant if the latter two
  are unit upper-triangular (which is assumed but not checked) but may
  be handy if, for example, the Cholesky decomposition with a lower
  triangular matrix is available.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>If <code>what="coef"</code>,
  a matrix of the periodic model coefficients.</p>


<p>If <code>what="coef.and.var"</code>, alist containing the coefficients and
  the innovations' variances:</p>
<dl><dt>pcfilter</dt>
<dd><p>PAR coefficients, a matrix</p></dd>

  <dt>var</dt>
<dd><p>innovation variances, a vector</p></dd>


</dl><p>Otherwise the returned list contains an additional component,</p>
<p></p>
<p><code>Uform</code>, which is itself a list with components:</p>
<dl><dt>Sigma</dt>
<dd><p>covariance matrix of innovations,</p></dd>

  <dt>U0</dt>
<dd><p>coefficient for lag zero,</p></dd>

  <dt>U</dt>
<dd><p>the remaining AR coefficients,</p></dd>

  <dt>U0inv</dt>
<dd><p>the inverse of <code>U0</code>,</p></dd>

  <dt>perm</dt>
<dd><p>permutation giving the season of each variable.</p></dd>


</dl><p>Note: <code>U0</code> and <code>U</code> correspond to \(A0\) and \(A\) in the
  reference (Boshnakov and Iqelan 2009).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Boshnakov GN, Iqelan BM (2009).
“Generation of time series models with given spectral properties.”
<em>J. Time Series Anal.</em>, <b>30</b>(3), 349--368.
ISSN 0143-9782, <a href="https://doi.org/10.1111/j.1467-9892.2009.00617.x" class="external-link">doi:10.1111/j.1467-9892.2009.00617.x</a>
.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Georgi N. Boshnakov</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>This function uses some non-exported internal functions:</p><dl><dt>.ldl</dt>
<dd><p>Computes the LDL' Cholesky decomposition with unit
      lower-triangular matrix L,</p></dd>

    <dt>.udu</dt>
<dd><p>Computes the UDU' Cholesky decomposition with unit
      upper-triangular matrix U.</p></dd>

  
</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="mf_VSform.html">mf_VSform</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## create a pc filter</span></span>
<span class="r-in"><span class="va">rfi</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_pcfilter.html">sim_pcfilter</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"><span class="va">rfi</span><span class="op">$</span><span class="va">pcfilter</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]       [,2]         [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0.4043096  0.4578097  0.004512116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -171.9774781 68.7728939 78.485157397</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## turn it into VAR form</span></span>
<span class="r-in"><span class="va">flt</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"MultiFilter"</span>, coef <span class="op">=</span> <span class="va">rfi</span><span class="op">$</span><span class="va">pcfilter</span><span class="op">)</span></span>
<span class="r-in"><span class="va">I1</span> <span class="op">&lt;-</span> <span class="fu"><a href="mf_VSform.html">mf_VSform</a></span><span class="op">(</span><span class="va">flt</span>, form<span class="op">=</span><span class="st">"I"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## from VAR to scalar form</span></span>
<span class="r-in"><span class="va">flt2</span> <span class="op">&lt;-</span> <span class="fu">VAR2pcfilter</span><span class="op">(</span><span class="va">I1</span><span class="op">$</span><span class="va">Phi</span>, Sigma <span class="op">=</span> <span class="va">I1</span><span class="op">$</span><span class="va">Phi0inv</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">I1</span><span class="op">$</span><span class="va">Phi0inv</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## confirm that we are back to the original</span></span>
<span class="r-in"><span class="co">##   (VAR2pcfilter doesn't drop redundant zeroes, so we do it manually)</span></span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">flt2</span><span class="op">[</span> , <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="va">rfi</span><span class="op">$</span><span class="va">pcfilter</span><span class="op">)</span> <span class="co">## TRUE</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Georgi N. Boshnakov.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer></div>

  


  

  </body></html>

