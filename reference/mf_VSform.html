<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Extract properties of multi-filters — mf_VSform • mcompanion</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Extract properties of multi-filters — mf_VSform"><meta property="og:description" content="Extract properties for scalar and vector of seasons forms of multi-filters."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mcompanion</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5-4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/GeoBosh/mcompanion/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract properties of multi-filters</h1>
    
    <div class="hidden name"><code>mf_VSform.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extract properties for scalar and vector of seasons forms of multi-filters.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">mf_order</span><span class="op">(</span><span class="va">x</span>, i <span class="op">=</span> <span class="st">"max"</span>, form <span class="op">=</span> <span class="st">"pc"</span>, <span class="va">perm</span><span class="op">)</span>
<span class="fu">mf_period</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="fu">mf_poles</span><span class="op">(</span><span class="va">x</span>, blocks <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">mf_VSform</span><span class="op">(</span><span class="va">x</span>, first <span class="op">=</span> <span class="fl">1</span>, form <span class="op">=</span> <span class="st">"U"</span>, <span class="va">perm</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt> x </dt>
<dd><p>the filter, an object of class  <code>"MultiFilter"</code>.</p></dd>

  <dt> i </dt>
<dd><p>index, integer vector or a string.</p></dd>

  <dt> first </dt>
<dd><p>the first season of the year.</p></dd>

  <dt> form </dt>
<dd><p>the form of the filter to which the result refers,
    one of "pc", "I", "U", or "L", see Details.</p></dd>

  <dt> perm </dt>
<dd><p>permutation of the seasons within the year.</p></dd>

  <dt> blocks </dt>
<dd><p>request lengths of Jordan chains.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>For <code>mf_order</code>,
  if <code>i = "max"</code> a positive integer,
  otherwise a vector  of positive integers.</p>


<p>For <code>mf_period</code> the period of the filter, a positive integer.</p>


<p>For <code>mf_poles</code>,
  if <code>blocks = FALSE</code>, a vector of the eigenvalues of the associated
  multi-companion matrix, each eigenvalue repeated according to its
  algebraic multiplicity.
  If <code>blocks = TRUE</code>, a 2-column matrix with the eigenvalues in the
  first column and the lengths of the  Jordan chains in the second.
  There is one row  for each  chain (i.e. multiple eigenvalues are
  repeated according to their geometric multiplicity).</p>


<p>For <code>mf_VSform</code> a list with components:</p>
<dl><dt>Phi0</dt>
<dd><p>the zero lag coefficient, a matrix,</p></dd>

  <dt>Phi</dt>
<dd><p>the remaining coefficients, a matrix,</p></dd>

  <dt>Phi0inv</dt>
<dd><p>(<code>form=="I"</code> only) the inverse of the zero lag coefficient
    matrix of the vs-form, a matrix. (<strong>TODO:</strong> the name of this
    component is misleading since in the case <code>form = "I"</code> Phi0 is
    the identity matrix and <code>Phi0inv</code> is not equal to the inverse
    of Phi0.)</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    

<p>With the default <code>i=="max"</code> the function <code>mf_order</code> returns
  a single number, the order of the filter in the representation
  requested by <code>form</code>.
  The orders of the components may be obtained with the setting
  <code>i=="all"</code> which gives a vector whose j-th element is the order
  of the j-th component of the filter. A subset of these may be obtained
  with numeric <code>i</code> which is treated as standard index vector.
  Values for <code>i</code> other than the default are meaningful mainly for
  <code>form="pc"</code>.</p>
<p><code>mf_VSform</code> arranges the filter coefficients in one of the vector
  of seasons forms (todo: cite me). The component <code>Phi</code> of the
  result is a matrix obtained by putting the coefficient matrices next
  to each other, [A1 ... Ad].  If <code>perm</code> is provided, then the
  result is the same for "U" and "L".</p>
<p><code>mf_VSform</code> is called implicitly by the subscripting operation
  ("[") when needed, it is more flexible and is recommended for general
  use.</p>
<p>For the vector forms ("I", "U", and "L") the argument <code>perm</code>
  specifies the arrangement of the components of the filter in that
  form. For the I- and U-forms the default is <code>mf_period(x):1</code>, for
  the L-form it is <code>1:mf_period(x)</code>.</p>
<p>Currently <code>perm</code> may take on
  values that can  be obtained from the default by rotation, e.g. if the
  period is 4,  <code>perm</code> may be one of
  (4,3,2,1), (1,4,3,2), (2,1,4,3), (3,2,1,4) for the U-form,
  and
  (1,2,3,4), (4,1,2,3), (3,4,1,2), (2,3,4,1) for the L-form.
  Other permutations may be usefull in some situations but may not
  result in U- or L- forms (without further transformations).
  For I-form any permutation should be permissible when implemented
  (todo:).</p>
<p>For <code>mf_order</code> the argument <code>perm</code> affects the computation
  only, not the ordering in the result.  The result (if vector) is not
  permuted unless the argument <code>i</code> asks for this.
  For <code>mf_VSform</code> however such a behaviour would be very peculiar
  and the rows of the result are for the permuted seasons.
  In short, the i-th element of the result of <code>mf_order</code> (if
  vector) gives the order (in the requested form) of the i-th season
  but the i-th row of any of the matrices returned by  <code>mf_VSform</code>
  depends on <code>perm</code> and <code>form</code>.</p>
<p>Note: the terminology here reflects application to pc processes,
  probably should be made more neutral in this respect.</p>
<p>todo: (2013-03-26) <code>mf_order</code> seems unfinished.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Georgi N. Boshnakov</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p><!-- % -->
  Boshnakov GN (2002).
“Multi-companion matrices.”
<em>Linear Algebra Appl.</em>, <b>354</b>, 53--83.
ISSN 0024-3795, <a href="https://doi.org/10.1016/S0024-3795%2801%2900475-X" class="external-link">doi:10.1016/S0024-3795(01)00475-X</a>
.</p>  
<p>Boshnakov GN, Iqelan BM (2009).
“Generation of time series models with given spectral properties.”
<em>J. Time Series Anal.</em>, <b>30</b>(3), 349--368.
ISSN 0143-9782, <a href="https://doi.org/10.1111/j.1467-9892.2009.00617.x" class="external-link">doi:10.1111/j.1467-9892.2009.00617.x</a>
.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="MultiFilter-class.html">MultiFilter</a></code> and the examples there,
  <code><a href="mcStable.html">mcStable</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## simulate a 3x3 2-companion matrix</span></span>
<span class="r-in"><span class="co">##  and turn it into a multi-filter</span></span>
<span class="r-in"><span class="op">(</span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="mCompanion.html">mCompanion</a></span><span class="op">(</span><span class="st">"sim"</span>, dim<span class="op">=</span><span class="fl">3</span>, mo<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 x 3 Matrix of class "MultiCompanion"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]       [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.4604868 -0.7664607 -0.5473012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.3869573  0.2411131 -0.5816077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 1.0000000  0.0000000  0.0000000</span>
<span class="r-in"><span class="op">(</span><span class="va">flt</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"MultiFilter"</span>, mc <span class="op">=</span> <span class="va">m</span> <span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class "MultiFilter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "mc":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 x 3 Matrix of class "MultiCompanion"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]       [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.4604868 -0.7664607 -0.5473012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.3869573  0.2411131 -0.5816077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 1.0000000  0.0000000  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "coef":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]       [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.3869573 0.24111308 -0.5816077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.9410143 0.09635448 -0.9933516</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "order":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "sign":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">mf_period</span><span class="op">(</span><span class="va">flt</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-in"><span class="fu">mf_poles</span><span class="op">(</span><span class="va">flt</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6336026+0.000000i 0.0339986+0.954295i 0.0339986-0.954295i</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu">mf_poles</span><span class="op">(</span><span class="va">flt</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6336026 0.9549005 0.9549005</span>
<span class="r-in"><span class="fu">mf_VSform</span><span class="op">(</span><span class="va">flt</span>,form<span class="op">=</span><span class="st">"U"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Phi0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1 -0.9410143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0  1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Phi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]       [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.09635448 -0.9933516  0.0000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.38695728  0.2411131 -0.5816077    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">mf_VSform</span><span class="op">(</span><span class="va">flt</span>,form<span class="op">=</span><span class="st">"L"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Phi0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.0000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.9410143    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Phi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2] [,3]       [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.2411131 0.38695728    0 -0.5816077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.9933516 0.09635448    0  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">mf_VSform</span><span class="op">(</span><span class="va">flt</span>,form<span class="op">=</span><span class="st">"I"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Phi0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Phi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]       [,2]       [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.4604868 -0.7664607 -0.5473012    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.3869573  0.2411131 -0.5816077    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Phi0inv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1 0.9410143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## simulate a pc filter (2 seasons)</span></span>
<span class="r-in"><span class="co">## and turn it into a multi-filter object</span></span>
<span class="r-in"><span class="op">(</span><span class="va">rfi</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_pcfilter.html">sim_pcfilter</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eigval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.5861121+0.0000000i -0.2664762+0.7753333i -0.2664762-0.7753333i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $len.block</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eigvec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,1]                  [,2]                  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.5334526+0i -0.3202506-0.3435490i -0.3202506+0.3435490i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.2757404+0i -0.6309388+0.0909150i -0.6309388-0.0909150i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.9101546+0i -0.2693230+0.5056132i -0.2693230-0.5056132i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $co</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,1]                  [,2]                  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.2757404+0i -0.6309388+0.0909150i -0.6309388-0.0909150i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.9101546+0i -0.2693230+0.5056132i -0.2693230-0.5056132i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mo.col</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]          [,2]          [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.8449037 -1.190367e+00  4.781020e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 2.6227090 -1.963968e+00  1.119766e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 1.0000000 -8.714737e-18 -2.905370e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pcfilter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]       [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2.6227090 -1.9639681  1.1197662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.4269659 -0.2749037 -0.3518199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="op">(</span><span class="va">flt</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"MultiFilter"</span>, coef <span class="op">=</span> <span class="va">rfi</span><span class="op">$</span><span class="va">pcfilter</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class "MultiFilter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "mc":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 x 3 Matrix of class "MultiCompanion"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]     [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      0.8449037 -1.190367 0.478102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wrk2 2.6227090 -1.963968 1.119766</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1.0000000  0.000000 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "coef":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]       [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2.6227090 -1.9639681  1.1197662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.4269659 -0.2749037 -0.3518199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "order":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "sign":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">mf_period</span><span class="op">(</span><span class="va">flt</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-in"><span class="fu">mf_poles</span><span class="op">(</span><span class="va">flt</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.2664762+0.7753333i -0.2664762-0.7753333i -0.5861121+0.0000000i</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu">mf_poles</span><span class="op">(</span><span class="va">flt</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8198484 0.8198484 0.5861121</span>
<span class="r-in"><span class="fu">mf_VSform</span><span class="op">(</span><span class="va">flt</span>, form<span class="op">=</span><span class="st">"U"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Phi0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1 -0.4269659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0  1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Phi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]     [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.2749037 -0.3518199 0.000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  2.6227090 -1.9639681 1.119766    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">mf_VSform</span><span class="op">(</span><span class="va">flt</span>, form<span class="op">=</span><span class="st">"I"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Phi0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Phi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]     [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.8449037 -1.190367 0.478102    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 2.6227090 -1.963968 1.119766    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Phi0inv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1 0.4269659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    0 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">mf_VSform</span><span class="op">(</span><span class="va">flt</span>, form<span class="op">=</span><span class="st">"L"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Phi0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.0000000    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.4269659    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Phi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2] [,3]     [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -1.9639681  2.6227090    0 1.119766</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.3518199 -0.2749037    0 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## indexing can be used  to extract filter coefficients</span></span>
<span class="r-in"><span class="va">flt</span><span class="op">[</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]       [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2.6227090 -1.9639681  1.1197662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.4269659 -0.2749037 -0.3518199</span>
<span class="r-in"><span class="va">flt</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]      [,2]     [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2.622709 -1.963968 1.119766</span>
<span class="r-in"><span class="co">## the rest are some checks of numerical performance.</span></span>
<span class="r-in"><span class="va">rfi</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eigval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.5861121+0.0000000i -0.2664762+0.7753333i -0.2664762-0.7753333i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $len.block</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eigvec</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,1]                  [,2]                  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.5334526+0i -0.3202506-0.3435490i -0.3202506+0.3435490i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.2757404+0i -0.6309388+0.0909150i -0.6309388-0.0909150i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.9101546+0i -0.2693230+0.5056132i -0.2693230-0.5056132i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $co</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,1]                  [,2]                  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.2757404+0i -0.6309388+0.0909150i -0.6309388-0.0909150i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.9101546+0i -0.2693230+0.5056132i -0.2693230-0.5056132i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mo.col</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]          [,2]          [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.8449037 -1.190367e+00  4.781020e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 2.6227090 -1.963968e+00  1.119766e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 1.0000000 -8.714737e-18 -2.905370e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pcfilter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]       [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2.6227090 -1.9639681  1.1197662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.4269659 -0.2749037 -0.3518199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="va">rfi</span><span class="op">$</span><span class="va">mat</span><span class="op">==</span><span class="fl">0</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] FALSE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] FALSE FALSE FALSE</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/zapsmall.html" class="external-link">zapsmall</a></span><span class="op">(</span><span class="va">rfi</span><span class="op">$</span><span class="va">mat</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]     [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.8449037 -1.190367 0.478102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 2.6227090 -1.963968 1.119766</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 1.0000000  0.000000 0.000000</span>
<span class="r-in"><span class="fu"><a href="mCompanion.html">mCompanion</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/zapsmall.html" class="external-link">zapsmall</a></span><span class="op">(</span><span class="va">rfi</span><span class="op">$</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 x 3 Matrix of class "MultiCompanion"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]     [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.8449037 -1.190367 0.478102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 2.6227090 -1.963968 1.119766</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 1.0000000  0.000000 0.000000</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="fu"><a href="mCompanion.html">mCompanion</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/zapsmall.html" class="external-link">zapsmall</a></span><span class="op">(</span><span class="va">rfi</span><span class="op">$</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;S4 Type Object&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"xtop")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]     [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.8449037 -1.190367 0.478102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 2.6227090 -1.963968 1.119766</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"mo")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"ido")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"mo.col")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"pad")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class "objectPad"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (x) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (missing(x)) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sklad</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     else sklad[[x]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55a1dda235b0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55a1e5402438&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (x, value) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sklad[[x]] &lt;&lt;- value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55a1dda27098&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55a1e5402438&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"x")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0.8449037  2.6227090  1.0000000 -1.1903673 -1.9639681  0.0000000  0.4781020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8]  1.1197662  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"Dim")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"Dimnames")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"Dimnames")[[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"Dimnames")[[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"factors")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> list()</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="fu"><a href="mCompanion.html">mCompanion</a></span><span class="op">(</span><span class="va">rfi</span><span class="op">$</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;S4 Type Object&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"xtop")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]          [,2]          [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.8449037 -1.190367e+00  4.781020e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 2.6227090 -1.963968e+00  1.119766e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 1.0000000 -8.714737e-18 -2.905370e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"mo")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"ido")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"mo.col")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"pad")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class "objectPad"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (x) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (missing(x)) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sklad</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     else sklad[[x]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55a1dda235b0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55a1e54aaa60&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (x, value) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sklad[[x]] &lt;&lt;- value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55a1dda27098&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55a1e54aaa60&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"x")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  8.449037e-01  2.622709e+00  1.000000e+00 -1.190367e+00 -1.963968e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] -8.714737e-18  4.781020e-01  1.119766e+00 -2.905370e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"Dim")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"Dimnames")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"Dimnames")[[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"Dimnames")[[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"factors")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> list()</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">flt1</span> <span class="op">&lt;-</span> <span class="fu">new</span><span class="op">(</span><span class="st">"MultiFilter"</span>, mc <span class="op">=</span> <span class="fu"><a href="mCompanion.html">mCompanion</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/zapsmall.html" class="external-link">zapsmall</a></span><span class="op">(</span><span class="va">rfi</span><span class="op">$</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">flt2</span> <span class="op">&lt;-</span> <span class="va">flt</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">flt1</span><span class="op">[</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]       [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2.6227090 -1.9639681  1.1197662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.4269659 -0.2749036 -0.3518199</span>
<span class="r-in"><span class="va">flt2</span><span class="op">[</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]       [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2.6227090 -1.9639681  1.1197662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.4269659 -0.2749037 -0.3518199</span>
<span class="r-in"><span class="va">flt1</span><span class="op">[</span><span class="op">]</span> <span class="op">-</span> <span class="va">flt2</span><span class="op">[</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,1]         [,2]        [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  2.630061e-08 1.171489e-08 -4.3059e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -1.283310e-08 6.844279e-09  1.2184e-08</span>
<span class="r-in"><span class="va">rfi</span><span class="op">$</span><span class="va">pcfilter</span> <span class="op">-</span> <span class="va">rfi</span><span class="op">$</span><span class="va">mat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]       [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.777805 -0.7736008  0.6416642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -2.195743  1.6890645 -1.4715861</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">mf_poles</span><span class="op">(</span><span class="va">flt1</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.2664762+0.7753333i -0.2664762-0.7753333i -0.5861121+0.0000000i</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu">mf_poles</span><span class="op">(</span><span class="va">flt1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8198484 0.8198484 0.5861121</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="va">rfi</span><span class="op">$</span><span class="va">mat</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $d</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.8378166 0.7763696 0.1322193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $u</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]        [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.3845250  0.53372974  0.7531754</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.9020684 -0.04402668 -0.4293416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.1959925 -0.84450827  0.4983901</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $v</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]        [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.7521835 -0.6556506  0.06589681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.5808927 -0.7069667 -0.40343744</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.3111008  0.2651800 -0.91263127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/kappa.html" class="external-link">rcond</a></span><span class="op">(</span><span class="va">rfi</span><span class="op">$</span><span class="va">mat</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.02859534</span>
<span class="r-in"><span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/rcond.html" class="external-link">rcond</a></span><span class="op">(</span><span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html" class="external-link">Matrix</a></span><span class="op">(</span><span class="va">rfi</span><span class="op">$</span><span class="va">mat</span><span class="op">)</span>,<span class="st">"O"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.02859534</span>
<span class="r-in"><span class="fl">1</span><span class="op">/</span><span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/rcond.html" class="external-link">rcond</a></span><span class="op">(</span><span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html" class="external-link">Matrix</a></span><span class="op">(</span><span class="va">rfi</span><span class="op">$</span><span class="va">mat</span><span class="op">)</span>,<span class="st">"O"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 34.97073</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Georgi N. Boshnakov.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer></div>

  


  

  </body></html>

