<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Simulate a multi-companion matrix with partially or  fully specified spectral
  properties."><title>Simulate a multi-companion matrix — sim_mc • mcompanion</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate a multi-companion matrix — sim_mc"><meta property="og:description" content="Simulate a multi-companion matrix with partially or  fully specified spectral
  properties."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mcompanion</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5-4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/GeoBosh/mcompanion/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulate a multi-companion matrix</h1>
      
      <div class="d-none name"><code>sim_mc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulate a multi-companion matrix with partially or  fully specified spectral
  properties.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">sim_mc</span><span class="op">(</span><span class="va">dim</span>, <span class="va">mo</span>, mo.col <span class="op">=</span> <span class="va">dim</span>, <span class="va">eigval</span>, <span class="va">len.block</span>, type.eigval <span class="op">=</span> <span class="cn">NULL</span>,
       <span class="va">co</span>, <span class="va">eigabs</span>, <span class="va">eigsign</span>, type <span class="op">=</span> <span class="st">"real"</span>,
       value <span class="op">=</span> <span class="st">"real"</span>, value.type <span class="op">=</span> <span class="st">""</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dim</dt>
<dd><p>dimension of the matrix.</p></dd>

  <dt>mo</dt>
<dd><p>multi-companion order.</p></dd>

  <dt>mo.col</dt>
<dd><p>number of structural columns.</p></dd>

  <dt>eigval</dt>
<dd><p>eigenvalues, one for each Jordan block.</p></dd>

  <dt>len.block</dt>
<dd><p>lengths of the Jordan blocks corresponding to <code>eigval</code>.</p></dd>
 
  <dt>type.eigval</dt>
<dd><p>types of the eigenvalues, a character vector</p></dd>

  <dt>co</dt>
<dd><p><code>co</code> parameters, see Details.</p></dd>

  <dt>eigabs</dt>
<dd><p>moduli (absolute values) of eigenvalues, see Details.</p></dd>

  <dt>eigsign</dt>
<dd><p>signs or complex arguments of eigenvalues, see Details.</p></dd>

  <dt>type</dt>
<dd><p>passed down to generators (???)</p></dd>

  <dt>value</dt>
<dd><p>what to return</p></dd>

  <dt>value.type</dt>
<dd><p>type of the value (???)</p></dd>

  <dt>...</dt>
<dd><p>further arguments to passed on to <code>sim_chains</code> and
    <code>sim_numbers</code>, see Details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    

<p><code>sim_mc</code> generates a multi-companion matrix of dimension
  <code>dim x dim</code> and multi-companion order <code>mo</code>. The matrix has
  the spectral properties specified by the arguments. Values that cannot
  be inferred from the arguments are simulated.</p>
<p>Arguments <code>dim</code>, <code>mo</code>, and <code>mo.col</code> define the
  structure of the matrix. The first two are compulsory but the last
  one, <code>mo.col</code>, is optional. If no other arguments are supplied
  <code>sim_mc</code> produces a matrix with all spectral parameters
  simulated.</p>
<p>The number of non-zero eigenvalues is at most <code>mo.col</code>.
  If <code>mo.col &lt; dim</code> the multi-companion matrix has structural
  eigenvectors/chains corresponding to the zero eigenvalue(s), see
  the references. These chains are generated automatically.</p>
<p>Arguments <code>type.eigval</code>, <code>eigabs</code>, <code>eigsign</code> and
  <code>eigval</code> are vectors used to specify the types and the values of
  the eigenvalues. Any or all of them may be missing or NULL. Those
  present must have the same length.</p>
<p>It is not necessary to specify eigenvalues and eigenvectors
  corresponding to eigenvalues equal to zero, since the structural
  eigenchains needed when <code>mo.col &lt; dim</code> are created automatically.
  In practice, the number of the non-zero eigenvalues is usually equal
  to <code>mo.col</code>.  The net effect is that the arguments specifying the
  spectral structure of the matrix normally need to specify the spectral
  information about the non-zero <code>eigval</code> only.</p>
<p>Some or all of the eigenvalues may be specified partially or fully
  using arguments <code>eigabs</code>, <code>eigsign</code>, and
  <code>eigval</code>. Non-NA entries in <code>eigval</code> specify complete
  eigenvalues. Non-NA entries in <code>eigabs</code> specify absolute values
  of eigenvalues. Non-NA entries in <code>eigsign</code> specify signs of real
  eigenvalues or complex arguments of complex eigenvalues. Generally, if
  the entry for an eigenvalue in <code>eigval</code> is a number (not
  <code>NA</code>), then the corresponding entries in <code>eigabs</code> and
  <code>eigsign</code> will be <code>NA</code>. This is not enforced and a limited
  check for consistency is made in case of redundant information.</p>
<p><code>type.eigval</code> is a character vector describing the types of the
  eigenvalues, where "r", "c", and "cp" stand for real, complex, and
  complex pair, respectively. It is best to have one entry only for each
  complex pair (specified by "cp"), rather than two "c" entries.</p>
<p>If <code>type.eigval</code> is NULL (default) and <code>eigval</code> is supplied,
  then <code>type.eigval</code> is inferred from the imaginary part of
  <code>eigval</code> ("r" or "cp"), if it is complex.</p>
<p>For compatibility with older versions of this function <code>eigval</code>
  may be a character vector in which case it is simply assigned to
  <code>type.eigval</code>.</p>
<p>If both, <code>type.eigval</code> and <code>eigval</code>, are missing a default
  allocation of the types of the eigenvalues is chosen.</p>

<p><strong>TODO: complete the description below.</strong></p>
<p>The remaining spectral parameters may be specified with the argument
  <code>co</code> with missing entries for the "free" entries. (!!! This is not
  complete, it may be better to have separate arguments for the absolute
  value and the angle, as for eigenvalues, and an option for
  normalisation of these coefficients. ???)</p>
<p>Generators other than the default ones may be specified in the
  <code>...</code>  argument. These are passed to <code>sim_numbers</code> and
  <code>sim_chains</code>.  Again, for the "co" arguments the support
  is not finished.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>if <code>value.type</code> is the character string <code>"matrix"</code>, the
  required multi-companion matrix. Otherwise, if</p>
<p></p>
<p><code>value.type=="list"</code>, a list containing also the spectral
  information (this list is the same as the one from</p>
<p></p>
<p><code><a href="make_mcmatrix.html">make_mcmatrix</a></code>)).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p><!-- % -->
  Boshnakov GN (2002).
“Multi-companion matrices.”
<em>Linear Algebra Appl.</em>, <b>354</b>, 53--83.
ISSN 0024-3795, <a href="https://doi.org/10.1016/S0024-3795%2801%2900475-X" class="external-link">doi:10.1016/S0024-3795(01)00475-X</a>
.</p>  
<p>Boshnakov GN, Iqelan BM (2009).
“Generation of time series models with given spectral properties.”
<em>J. Time Series Anal.</em>, <b>30</b>(3), 349--368.
ISSN 0143-9782, <a href="https://doi.org/10.1111/j.1467-9892.2009.00617.x" class="external-link">doi:10.1111/j.1467-9892.2009.00617.x</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Georgi N. Boshnakov</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>A canonical form is needed, especially when there are repeated
  eigenvalues whose eigenvectors may be chosen to be orthogonal, at
  least. (nyakade v zapiskite mi tryabva da ima kanonichna forma!)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">

<p><code><a href="https://geobosh.github.io/gbutils/reference/sim_numbers.html" class="external-link">gbutils::sim_numbers</a></code> and
  <code><a href="sim_chains.html">sim_chains</a></code> for arguments that control the
  distributions of the random numbers.</p>
<p><code><a href="make_mcmatrix.html">make_mcmatrix</a></code> creates the matrix.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu">sim_mc</span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>   <span class="co"># simulate 3x3 2-companion matrix</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">m0</span><span class="op">$</span><span class="va">eigval</span><span class="op">)</span>      <span class="co"># eigval random, so their abs values</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4166381 0.6759703 0.6759703</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># now fix moduli of eigenvalues, and</span></span>
<span class="r-in"><span class="co"># ask for one real ev and one complex pair of ev's</span></span>
<span class="r-in"><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">sim_mc</span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span>,eigabs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.5</span><span class="op">)</span>, type.eigval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r"</span>,<span class="st">"cp"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">m1</span><span class="op">$</span><span class="va">eigval</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.2500000+0.0000000i -0.2183333+0.4498117i -0.2183333-0.4498117i</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">eigval</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.25 0.50 0.50</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># same as above, since type.eigval happens to be the default</span></span>
<span class="r-in"><span class="co"># dim is odd, by default first ev is real, rest are complex pairs</span></span>
<span class="r-in"><span class="va">m1a</span> <span class="op">&lt;-</span> <span class="fu">sim_mc</span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span>,eigabs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">m1a</span><span class="op">$</span><span class="va">eigval</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.2500000+0.0000000i -0.4747369-0.1569233i -0.4747369+0.1569233i</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">m1a</span><span class="op">$</span><span class="va">eigval</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.25 0.50 0.50</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># simulate 6x6 4-companion matrix</span></span>
<span class="r-in"><span class="co"># with ev's at the seasonal frequencies (1.57 3.141593 -1.57)</span></span>
<span class="r-in"><span class="co"># and random moduli. 3 complex pairs of ev's</span></span>
<span class="r-in"><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">sim_mc</span><span class="op">(</span><span class="fl">6</span>,<span class="fl">4</span>, eigsign <span class="op">=</span> <span class="va">pi</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> <span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Arg</a></span><span class="op">(</span><span class="va">m2</span><span class="op">$</span><span class="va">eigval</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  1.570796  3.141593 -1.570796 -1.570796 -3.141593  1.570796</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Georgi N. Boshnakov.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer></div>

  

  

  </body></html>

